name: SSH Bruteforce Suspected
type: frequency
index: filebeat-*
num_events: 10
timeframe:
  minutes: 5

filter:
- query:
    query_string:
      query: "(system.auth.ssh.event:Failed OR message:*Failed*password*) AND (program:sshd OR process.name:sshd)"

query_key: source.ip
realert:
  minutes: 30

alert:
- debug
alert_text: |
  SSH bruteforce suspected from {0}. 10 failures within 5 minutes.
alert_text_args: [query_key]

